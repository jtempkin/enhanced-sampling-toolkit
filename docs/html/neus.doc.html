<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Nonequilibrium Umbrella Sampling (NEUS) &#8212; Enhanced Sampling Toolkit 0.1a documentation</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Enhanced Sampling Toolkit 0.1a documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-neus">
<span id="nonequilibrium-umbrella-sampling-neus"></span><h1>Nonequilibrium Umbrella Sampling (NEUS)<a class="headerlink" href="#module-neus" title="Permalink to this headline">¶</a></h1>
<p>The Nonequilibrium Umbrella Sampling (NEUS) application module provides a flexible set of tools built on top of the Walker API that implements the components of the NEUS algorithm described in (NEUS paper citation).</p>
<p>The NEUS toolkit provided in this package contains three modules:</p>
<ul class="simple">
<li>A module called Window that implements the data structures and routines that represent a single spatiotemporal discretization in the NEUS scheme. An instance of the Window object corresponds to a single value of the <span class="math">\(J^{(t)}\)</span> process.</li>
<li>A module called partition acts as a collection of these windows objects that expresses the full <span class="math">\(J^{(t)}\)</span> index space.</li>
<li>A module called entry points that provides a named tuple for storing phase space points as elements in the <span class="math">\(\tilde \gamma_{ij}\)</span></li>
</ul>
<p>Below we describe the basic usage of the NEUS toolkit. Please see the Jupyter notebooks provided in the data folder for an interactive version.</p>
<div class="section" id="neus-module-basic-usage">
<h2>NEUS Module Basic Usage<a class="headerlink" href="#neus-module-basic-usage" title="Permalink to this headline">¶</a></h2>
<p>The NEUS application toolkit provides three modules:</p>
<ul class="simple">
<li>A Window object</li>
<li>A partition object</li>
<li>An Entry Point collection</li>
</ul>
<p>The Window object represents the data strutures and routines that
represent a single spatiotemporal restriction, or a single &#8220;window&#8221; in
your NEUS scheme. In the language of NEUS, this corresponds to a single
restricted value of the <span class="math">\(J^{(t)}\)</span> process.</p>
<p>The partition object represents a callable list of Window instances.
Again, in the language of NEUS, it represents the full index space of
the <span class="math">\(J^{(t)}\)</span> process.</p>
<p>The entry point module provides a named tuple structure for storing the
state of the system at a particular point in phase space.</p>
<p>In the following, we will illustrate some basic usage of these objects
with the idea of familiarizing the user with their tools and syntax.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">neus</span> <span class="k">import</span> <span class="n">pyramid</span>
<span class="kn">from</span> <span class="nn">neus</span> <span class="k">import</span> <span class="n">partition</span>
</pre></div>
</div>
<div class="section" id="window-objects">
<h3>Window objects<a class="headerlink" href="#window-objects" title="Permalink to this headline">¶</a></h3>
<p>The NEUS application in the toolkit provides a parent module called
&#8220;window&#8221;. The shape of the support of each window can be customized by
writing a class that inherents from the window parent class.</p>
<p>For example, the NEUS toolkit provides a pyramidal shaped module named
neus.pyramid.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># instantiate a window object</span>
<span class="n">center</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<span class="n">width</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">win</span> <span class="o">=</span> <span class="n">pyramid</span><span class="o">.</span><span class="n">Pyramid</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>

<span class="c1"># plot the support of the pyramid object</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">win</span><span class="p">([</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span> <span class="n">at</span> <span class="mh">0x10f399c10</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<img alt="_images/output_3_1.png" src="_images/output_3_1.png" />
</div>
<div class="section" id="partition-objects">
<h3>Partition objects<a class="headerlink" href="#partition-objects" title="Permalink to this headline">¶</a></h3>
<p>The NEUS toolkit provides the partition class that represents a
collection of window objects. It&#8217;s implementation is effectively a
callable list, whose call function returns a normlized vector of the
supports of it&#8217;s elements. Note that it enforces that each element of a
partition must itself be a callable object.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># create an empty partition object</span>
<span class="n">sys</span> <span class="o">=</span> <span class="n">partition</span><span class="o">.</span><span class="n">Partition</span><span class="p">()</span>

<span class="c1"># create a list of winodw objects</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.75</span>

<span class="n">centers</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>

<span class="c1"># now add the windows to partition</span>
<span class="k">for</span> <span class="n">center</span> <span class="ow">in</span> <span class="n">centers</span><span class="p">:</span>
    <span class="n">win</span> <span class="o">=</span> <span class="n">pyramid</span><span class="o">.</span><span class="n">Pyramid</span><span class="p">([</span><span class="n">center</span><span class="p">],</span> <span class="p">[</span><span class="n">width</span><span class="p">])</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">win</span><span class="p">)</span>


<span class="nb">print</span> <span class="n">sys</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">partition</span><span class="p">([</span><span class="n">Pyramid</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">]),</span> <span class="n">Pyramid</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">]),</span> <span class="n">Pyramid</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">]),</span> <span class="n">Pyramid</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">]),</span> <span class="n">Pyramid</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">]),</span> <span class="n">Pyramid</span><span class="p">([</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">])])</span>
</pre></div>
</div>
<p>Partition objects act like callable lists so some of the expected list
operations also work with partitons:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># element access</span>
<span class="nb">print</span> <span class="n">sys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># slicing</span>
<span class="nb">print</span> <span class="n">sys</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

<span class="c1"># list concatenation</span>
<span class="nb">print</span> <span class="n">sys</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">sys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Pyramid</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">])</span>
<span class="p">[</span><span class="n">Pyramid</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">]),</span> <span class="n">Pyramid</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">])]</span>
<span class="p">[</span><span class="n">Pyramid</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">]),</span> <span class="n">Pyramid</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">]),</span> <span class="n">Pyramid</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span> <span class="mf">0.75</span><span class="p">])]</span>
</pre></div>
</div>
<p>The partition&#8217;s call routine returns the normalized vector of supports:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># choose a point with nonzero support</span>
<span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">]</span>

<span class="c1"># return normalized vector of the support</span>
<span class="nb">print</span> <span class="n">sys</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">0.</span> <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="partition-module-api">
<h2>Partition Module API<a class="headerlink" href="#partition-module-api" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="neus.partition.Partition">
<em class="property">class </em><code class="descclassname">neus.partition.</code><code class="descname">Partition</code><span class="sig-paren">(</span><em>umbrellas=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="neus.partition.Partition.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>pos</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy array of the normalized supports of the windows at the given.</p>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.__contains__">
<code class="descname">__contains__</code><span class="sig-paren">(</span><em>item</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.__contains__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.__contains__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return boolean for if the partition contains the specified item.</p>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.__delitem__">
<code class="descname">__delitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.__delitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.__delitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete window.</p>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an item in the list.</p>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>umbrellas=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an instance of the partition.</p>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.__iter__">
<code class="descname">__iter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.__iter__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator for the list of basis functions.</p>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.__len__">
<code class="descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.__len__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of windows in the partition.</p>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.__repr__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string representation of the partition.</p>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.__setitem__">
<code class="descname">__setitem__</code><span class="sig-paren">(</span><em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.__setitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.__setitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Set item to value.</p>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.append"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a new value to the partition.</p>
<p>Note that this enforces that the input object is callable. Will throw an exception if value is not callable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>value</strong> : obj</p>
<blockquote>
<div><p>A callable Python object.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.partition.Partition.index">
<code class="descname">index</code><span class="sig-paren">(</span><em>item</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/partition.html#Partition.index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.partition.Partition.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first index in which item appears in partition.</p>
<p>Extended description.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>item</strong> : obj</p>
<blockquote>
<div><p>The window object to check for membership.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>index</strong> : int</p>
<blockquote class="last">
<div><p>The index of item in the list. Returns ValueError if item is not
contained in the partition.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-neus.window">
<span id="window-module-api"></span><h2>Window Module API<a class="headerlink" href="#module-neus.window" title="Permalink to this headline">¶</a></h2>
<p>The window object defines a single spatiotemporal restriction of the discretization defined by the NEUS <span class="math">\(J^{(t)}\)</span> process. An instance of the window object corresponds to a single value of the <span class="math">\(J^{(t)}\)</span>. The object defines a data structure for storing the entry point flux lists defined by <span class="math">\(\pi_{i}(t,xd)\)</span>. It also defines the routines require for constructing the flux lists and returning physically weighted elements.</p>
<p>This object contains the following attributes:</p>
<ul class="simple">
<li>data structure for containing flux lists</li>
<li>data structure for the initial conditions distribution at <span class="math">\(J^{(0)}\)</span></li>
<li>a list of physical fluxes used to draw entry points proportionally</li>
<li>routines for reinjection</li>
<li>routines for updating fluxes</li>
<li>routines for updating entry point lists</li>
</ul>
<dl class="class">
<dt id="neus.window.Window">
<em class="property">class </em><code class="descclassname">neus.window.</code><code class="descname">Window</code><span class="sig-paren">(</span><em>center</em>, <em>width</em>, <em>ref_center=None</em>, <em>ref_width=None</em>, <em>time=None</em>, <em>periodic_length=None</em>, <em>max_list_size=100</em>, <em>initial_conditions=[]</em>, <em>initial_conditions_probability=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="neus.window.Window.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>center</em>, <em>width</em>, <em>ref_center=None</em>, <em>ref_width=None</em>, <em>time=None</em>, <em>periodic_length=None</em>, <em>max_list_size=100</em>, <em>initial_conditions=[]</em>, <em>initial_conditions_probability=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an intsance of a window object.</p>
<p>Note that the width parameter refers to the maximum distance in each direction for which this window is defined to have nonzero support.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>center</strong> : numpy.ndarray, list</p>
<blockquote>
<div><p>The coordinates of the center of the window support.</p>
</div></blockquote>
<p><strong>width</strong> : numpy.ndarray, list</p>
<blockquote>
<div><p>The width of the support of the window.</p>
</div></blockquote>
<p><strong>ref_center</strong> : numpy.ndarray, list (None)</p>
<blockquote>
<div><p>The center of the support in the reference configuration at time <span class="math">\(t=0\)</span></p>
</div></blockquote>
<p><strong>ref_width</strong> : numpy.ndarray, list (None)</p>
<blockquote>
<div><p>The width of the support of the reference configuration at time <span class="math">\(t=0\)</span></p>
</div></blockquote>
<p><strong>time</strong> : numpy.ndarray, list (None)</p>
<blockquote>
<div><p>The time interval for which this window has nonzero support.</p>
</div></blockquote>
<p><strong>periodic_length</strong> : numpy.ndarray, list (None)</p>
<blockquote>
<div><p>The length of the periodicity for each coordinate this window supports.</p>
</div></blockquote>
<p><strong>max_list_size</strong> : interval (100)</p>
<blockquote>
<div><p>The maximum size of each <span class="math">\(\gamma_{ij}\)</span> distribution.</p>
</div></blockquote>
<p><strong>initial_conditions</strong> : iterable</p>
<blockquote>
<div><p>The iterable of entry point objects at time <span class="math">\(t=0\)</span>.</p>
</div></blockquote>
<p><strong>initial_conditions_probability</strong> : float</p>
<blockquote class="last">
<div><p>A float between 0.0 and 1.0.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.__len__">
<code class="descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.__len__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total number of entry points stored in this window.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>len</strong> : int</p>
<blockquote class="last">
<div><p>The total number of entry points stored in the flux lists.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.__nonzero__">
<code class="descname">__nonzero__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.__nonzero__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.__nonzero__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return boolean value of the window.</p>
<p>Returns True if there is at least one entry point stored in the flux lists or if there is at least one entry point stored in the initial conditions library. Returns False otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bool</p>
<blockquote class="last">
<div><p>True if there is at least one entry point stored in the flux lists. False otherwise.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.__repr__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the string representation of this window instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>repr</strong> : string</p>
<blockquote class="last">
<div><p>Returns the string represenation of the window.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.add_entry_point">
<code class="descname">add_entry_point</code><span class="sig-paren">(</span><em>ep</em>, <em>key</em>, <em>weight=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.add_entry_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.add_entry_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new entry point to the specified flux list.</p>
<p>If key is not already know, create a new set with label &#8220;key&#8221; and add it to the dictionary. Keys should be the index of the corresponding neighbor window.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ep</strong> : entry_point</p>
<blockquote>
<div><p>The entry point to add to <span class="math">\(\gamma_{ij}\)</span></p>
</div></blockquote>
<p><strong>key</strong> : int</p>
<blockquote>
<div><p>The <span class="math">\(i\)</span> index of the neighbor.</p>
</div></blockquote>
<p><strong>weight</strong> : float (1.0)</p>
<blockquote class="last">
<div><p>The weight of the entry_point object.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.clear_flux_list">
<code class="descname">clear_flux_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.clear_flux_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.clear_flux_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the <span class="math">\(\gamma_{ij}\)</span> of all entries.</p>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.get_entry_point">
<code class="descname">get_entry_point</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.get_entry_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.get_entry_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an entry point from the <span class="math">\(\gamma_{ij}\)</span>.</p>
<p>This routine selects a <span class="math">\(\gamma_{ij}\)</span> with probability proportional to the value stored in the fluxes array attribute. Once the <span class="math">\(\gamma_{ij}\)</span> is chosen, the entry point is selected from <span class="math">\(\gamma_{ij}\)</span> proportional to the weight of each entry point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">entry_point</p>
<blockquote class="last">
<div><p>An entry point object.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.get_flux_lists">
<code class="descname">get_flux_lists</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.get_flux_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.get_flux_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dictionary of the flux lists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dictionary</p>
<blockquote class="last">
<div><p>The dictionary of the <span class="math">\(\gamma_{ij}\)</span></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.get_flux_weights">
<code class="descname">get_flux_weights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.get_flux_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.get_flux_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dictionary of the entry_point weights.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dictionary</p>
<blockquote class="last">
<div><p>A dictionary of the entry point weights.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.get_initial_conditions">
<code class="descname">get_initial_conditions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.get_initial_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.get_initial_conditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distribution of initial conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">iterable</p>
<blockquote class="last">
<div><p>An iterable of the initial conditions.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.reinject">
<code class="descname">reinject</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.reinject"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.reinject" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an entry point drawn proportional to the neighbor fluxes.</p>
<p>This routine will attempt to return an entry point from the initial distribution attribute with probability equal to value stored in the initial_conditions_probability attribute. With remaining probability, it attempts to draw an entry point from the weighted flux lists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ep</strong> : entry_point</p>
<blockquote class="last">
<div><p>Returns an entry point.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.set_initial_conditions">
<code class="descname">set_initial_conditions</code><span class="sig-paren">(</span><em>distribution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.set_initial_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.set_initial_conditions" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the distribution of initial conditions to this window.</p>
<p>This set corresponds the distribution of the process at J(0). Distribution is expected to be an iterable of entry point objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>distribution</strong> : iterable</p>
<blockquote class="last">
<div><p>An iterable of entry_point objects.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.set_initial_conditions_probability">
<code class="descname">set_initial_conditions_probability</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.set_initial_conditions_probability"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.set_initial_conditions_probability" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the probability for drawing from the initial conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>p</strong> : float</p>
<blockquote class="last">
<div><p>A float between 0.0 and 1.0.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.window.Window.update_fluxes">
<code class="descname">update_fluxes</code><span class="sig-paren">(</span><em>fluxes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/window.html#Window.update_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.window.Window.update_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Set neighbor fluxes.</p>
<p>Sets the array of fluxes observed from the neighboring windows.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fluxes</strong> : ndarray</p>
<blockquote class="last">
<div><p>A numpy array of the fluxes from the neighbors.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-neus.pyramid">
<span id="pyramid-module-api"></span><h2>Pyramid Module API<a class="headerlink" href="#module-neus.pyramid" title="Permalink to this headline">¶</a></h2>
<p>Class definition for Pyramid shaped window. Inherets from Window.</p>
<dl class="class">
<dt id="neus.pyramid.Pyramid">
<em class="property">class </em><code class="descclassname">neus.pyramid.</code><code class="descname">Pyramid</code><span class="sig-paren">(</span><em>center</em>, <em>width</em>, <em>ref_center=None</em>, <em>ref_width=None</em>, <em>time=None</em>, <em>periodic_length=None</em>, <em>max_list_size=100</em>, <em>initial_conditions=[]</em>, <em>initial_conditions_probability=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/pyramid.html#Pyramid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.pyramid.Pyramid" title="Permalink to this definition">¶</a></dt>
<dd><p>Class definition of Pyramid which inherits from window. Implements the pyramid shaped basis function.</p>
<dl class="method">
<dt id="neus.pyramid.Pyramid.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>walker</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/pyramid.html#Pyramid.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.pyramid.Pyramid.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the support for this Pyramid object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>walker</strong> : walker instance</p>
<blockquote>
<div><p>The walker instance for which to evaluate the support of the Pyramid.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The value of the support.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.pyramid.Pyramid.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>center</em>, <em>width</em>, <em>ref_center=None</em>, <em>ref_width=None</em>, <em>time=None</em>, <em>periodic_length=None</em>, <em>max_list_size=100</em>, <em>initial_conditions=[]</em>, <em>initial_conditions_probability=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/pyramid.html#Pyramid.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.pyramid.Pyramid.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an intsance of the Pyramid object.</p>
<p>Note that the width parameter refers to the maximum distance in each direction for which this window is defined to have nonzero support.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>center</strong> : numpy.ndarray, list</p>
<blockquote>
<div><p>The coordinates of the center of the window support.</p>
</div></blockquote>
<p><strong>width</strong> : numpy.ndarray, list</p>
<blockquote>
<div><p>The width of the support of the window.</p>
</div></blockquote>
<p><strong>ref_center</strong> : numpy.ndarray, list (None)</p>
<blockquote>
<div><p>The center of the support in the reference configuration at time <span class="math">\(t=0\)</span></p>
</div></blockquote>
<p><strong>ref_width</strong> : numpy.ndarray, list (None)</p>
<blockquote>
<div><p>The width of the support of the reference configuration at time <span class="math">\(t=0\)</span></p>
</div></blockquote>
<p><strong>time</strong> : numpy.ndarray, list (None)</p>
<blockquote>
<div><p>The time interval for which this window has nonzero support.</p>
</div></blockquote>
<p><strong>periodic_length</strong> : numpy.ndarray, list (None)</p>
<blockquote>
<div><p>The length of the periodicity for each coordinate this window supports.</p>
</div></blockquote>
<p><strong>max_list_size</strong> : interval (100)</p>
<blockquote>
<div><p>The maximum size of each <span class="math">\(\gamma_{ij}\)</span> distribution.</p>
</div></blockquote>
<p><strong>initial_conditions</strong> : iterable</p>
<blockquote>
<div><p>The iterable of entry point objects at time <span class="math">\(t=0\)</span>.</p>
</div></blockquote>
<p><strong>initial_conditions_probability</strong> : float</p>
<blockquote class="last">
<div><p>A float between 0.0 and 1.0.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.pyramid.Pyramid.ref_indicator">
<code class="descname">ref_indicator</code><span class="sig-paren">(</span><em>coord</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/pyramid.html#Pyramid.ref_indicator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.pyramid.Pyramid.ref_indicator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the support for the reference phase space point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>coord</strong> : numpy.ndarray</p>
<blockquote>
<div><p>The coordinates of the reference phase space point.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The value of the support on the reference coordinate.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="neus.pyramid.Pyramid.time_indicator">
<code class="descname">time_indicator</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neus/pyramid.html#Pyramid.time_indicator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#neus.pyramid.Pyramid.time_indicator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indicator function on the time interval.</p>
<p>Takes the value 1.0 if the time provided is in the time interval for which this window has nonzero support.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>time</strong> : int</p>
<blockquote>
<div><p>A time to evaluate.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The indicator value.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-neus.entry_points">
<span id="entry-point-module"></span><h2>Entry Point Module<a class="headerlink" href="#module-neus.entry_points" title="Permalink to this headline">¶</a></h2>
<p>This module acts as a template for defining named tuples that store the state of a system at a particular point.</p>
<p>The named tuple provide the following fields:</p>
<ul class="simple">
<li>q - the position vector of the system at time t</li>
<li>p - the velocity vector of the system at time t</li>
<li>ref_q - the position vector of the system at previous time t&#8217;</li>
<li>ref_p - the velocity vector of the system at previous time t&#8217;</li>
<li>time - the time of the system</li>
<li>cv - the value of the collective variable at time t</li>
</ul>
<p>The NEUS module provides the entry_point definition as an independent module so that analysis and manipulation of these objects is possible.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Nonequilibrium Umbrella Sampling (NEUS)</a><ul>
<li><a class="reference internal" href="#neus-module-basic-usage">NEUS Module Basic Usage</a><ul>
<li><a class="reference internal" href="#window-objects">Window objects</a></li>
<li><a class="reference internal" href="#partition-objects">Partition objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#partition-module-api">Partition Module API</a></li>
<li><a class="reference internal" href="#module-neus.window">Window Module API</a></li>
<li><a class="reference internal" href="#module-neus.pyramid">Pyramid Module API</a></li>
<li><a class="reference internal" href="#module-neus.entry_points">Entry Point Module</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Enhanced Sampling Toolkit 0.1a documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Jeremy O. B. Tempkin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>